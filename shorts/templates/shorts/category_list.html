{% extends "base.html" %}
{% load static %}
{% block body_block %}
    <h1>Publications</h1>
        <div class="central-card card-dark">
            <div class="card">
                <p class="attribution">
                    All publications by Maria Dong, organized by type and publication date.
                     Links to audio recordings and reviews provided where available.
                </p>
            </div>

        {% for category in object_list %}
        <h3><span class="highlighter">{{category.name}}</span></h3>
            {% for piece in category.pieces.all %}
            <p class="pieces-p">
                {% if not piece.published_date %}
                    <em>(Pending Publication.)</em>
                {% endif %}{{piece.title}}. 
            <a href="{{piece.piece_url}}" target="_blank" class="pieces-p">
                {{piece.published_in}}{% if piece.issue %}, #{{piece.issue}}{% endif %}</a>.
                {% if piece.published_date %}{{piece.published_date}}. {% endif %}
                ({{piece.word_count}} words{% if piece.genre %}{% for genre in piece.genre.all %}, {{genre.name}}{% endfor %}.{% else %}.{% endif %})
                {% if piece.audio_url %}
                    <a href="{{piece.audio_url}}" target="__blank">Audio Available</a>.
                {% endif %}
                {% if piece.review_set.all %}
                    Reviewed in:
                    {% for review in piece.review_set.all %}
                        <a href="{{review.review_url}}" target="__blank">{{review.review_venue}}</a>{% if not forloop.last %},{% else %}.{% endif %}{% endfor %}
                {% endif %}
            </p>
            <br>
            {% endfor %}
        {% endfor %}
        </div>
{% endblock %}
